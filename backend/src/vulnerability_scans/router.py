from typing import List

from fastapi import APIRouter, HTTPException
from fastapi.params import Depends
from fastapi.security import HTTPBearer
from sqlalchemy.ext.asyncio import AsyncSession

from .models import *
from ..database import db_manager, redis_client
from . import service
from ..auth.dependencies import get_current_active_auth_user
from ..dependencies import check_permission, Permission
from ..users.schemas import User
from .schemas import *

http_bearer = HTTPBearer(auto_error=False)
router = APIRouter(
    tags=["Host Scans"],
    prefix="/assets",
    dependencies=[
        Depends(http_bearer),
        # Depends(check_permission(Permission.USER)),
    ],
)
